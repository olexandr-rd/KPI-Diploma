# Система резервного копіювання даних енергосистеми

## Встановлення та запуск системи

### Передумови

Перед початком встановлення переконайтеся, що на вашій системі встановлено наступні компоненти:

- **Python 3.8 або новіша версія** - основна мова програмування для вебдодатка
- **PostgreSQL 12 або новіша версія** - система управління базами даних для зберігання енергетичних логів та резервних копій
- **Git** - система контролю версій для завантаження коду з репозиторію

### Завантаження проєкту

Спочатку склонуйте репозиторій з GitHub на ваш локальний комп'ютер, використовуючи наступну команду в терміналі:

```bash
git clone https://github.com/your-username/energy-monitoring-system.git
cd energy-monitoring-system
```

Після успішного клонування переконайтеся, що ви знаходитесь в кореневій директорії проєкту, де розташований файл `manage.py`.

### Налаштування бази даних PostgreSQL

Створіть нову базу даних PostgreSQL для системи моніторингу, а також користувача з відповідними правами доступу:

```sql
-- Увійдіть в PostgreSQL під адміністратором
sudo -u postgres psql

-- Створіть базу даних
CREATE DATABASE diploma;

-- Створіть користувача з паролем
CREATE USER energymanager WITH PASSWORD 'your_secure_password';

-- Надайте всі права на базу даних
GRANT ALL PRIVILEGES ON DATABASE diploma TO energymanager;

-- Вийдіть з PostgreSQL
\q
```

### Налаштування змінних середовища

Створіть файл `.env` в кореневій директорії проєкту для зберігання конфіденційних налаштувань:

```bash
# Створіть файл .env
touch .env
```

Відкрийте створений файл у текстовому редакторі та додайте наступні змінні середовища, замінивши значення на відповідні для вашої системи:

```env
SECRET_KEY=your-very-long-secret-key-here
DEBUG=True
DB_NAME=diploma
DB_USER=energymanager
DB_PASSWORD=your_secure_password
DB_HOST=localhost
DB_PORT=5432
```

Для генерації безпечного SECRET_KEY можете використати наступну команду Python:

```bash
python -c "import secrets; print(secrets.token_urlsafe(50))"
```

### Створення віртуального середовища

Створіть ізольоване віртуальне середовище Python для встановлення залежностей проєкту, що запобігає конфліктам з іншими Python-проєктами:

```bash
# Створіть віртуальне середовище
python -m venv venv

# Активуйте віртуальне середовище (Linux/macOS)
source venv/bin/activate

# Або для Windows
venv\Scripts\activate
```

Після активації віртуального середовища у терміналі повинен з'явитися префікс `(venv)`, що вказує на успішну активацію.

### Встановлення залежностей

Встановіть усі необхідні Python-пакети з файлу requirements.txt:

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

Цей процес може зайняти декілька хвилин, оскільки система завантажує та встановлює Django, PostgreSQL-драйвери, машинне навчання бібліотеки та інші компоненти.

### Налаштування бази даних Django

Виконайте міграції бази даних для створення необхідних таблиць:

```bash
# Застосуйте міграції до бази даних
python manage.py migrate
```

Створіть суперкористувача для доступу до адміністративної панелі Django:

```bash
python manage.py createsuperuser
```

Введіть запитувані дані: логін, email адресу та пароль для адміністративного облікового запису.

### Створення моделей машинного навчання

Для коректної роботи системи детекції аномалій та прогнозування необхідно створити початкові моделі машинного навчання:

```bash
# Згенеруйте тестові дані для навчання моделей
python ml/simulate_history.py

# Навчіть модель детекції аномалій
python ml/train_anomaly_model.py

# Навчіть модель прогнозування
python ml/train_forecast_model.py
```

Ці команди створять необхідні файли моделей у директорії `ml/model/`, які використовуватимуться системою для аналізу енергетичних даних.

### Запуск вебсервера

Запустіть Django сервер розробки для локального тестування системи:

```bash
python manage.py runserver
```

Сервер за замовчуванням запуститься на адресі `http://127.0.0.1:8000/`. Відкрийте цю адресу у веббраузері для доступу до системи моніторингу.

### Запуск планувальника автоматичних завдань

Для автоматичного збору даних, створення резервних копій та виконання регулярного обслуговування запустіть планувальник у окремому терміналі:

```bash
# У новому терміналі, активуйте віртуальне середовище
source venv/bin/activate

# Запустіть планувальник
python ml/manage_scheduler.py start
```

Планувальник працюватиме у фоновому режимі та автоматично виконуватиме заплановані завдання відповідно до налаштувань системи.

### Перевірка працездатності системи

Після успішного запуску вебсервера увійдіть до системи, використовуючи створений раніше суперкористувач. Перевірте наступні функції:

- **Панель моніторингу** повинна відображати статистику системи та останні записи енергосистеми
- **Розділ записів** дозволяє переглядати всі енергетичні логи з можливістю фільтрації
- **Резервні копії** показують створені автоматично або вручну бекапи даних
- **Аналітика** надає графічне представлення трендів навантаження та аномалій

### Керування планувальником

Для керування планувальником автоматичних завдань використовуйте наступні команди:

```bash
# Перевірити статус планувальника
python ml/manage_scheduler.py status

# Зупинити планувальник
python ml/manage_scheduler.py stop

# Перезапустити планувальник
python ml/manage_scheduler.py restart
```

### Налаштування ролей користувачів

Система підтримує три рівні доступу користувачів: звичайний користувач, менеджер та системний адміністратор. Після створення суперкористувача увійдіть до системи та створіть профіль користувача через адміністративну панель або інтерфейс керування користувачами.

### Вирішення можливих проблем

Якщо виникають помилки під час встановлення або запуску, перевірте наступні моменти:

- **Підключення до бази даних**: переконайтеся, що PostgreSQL працює та налаштування в файлі `.env` є коректними
- **Віртуальне середовище**: завжди активуйте віртуальне середовище перед виконанням команд Django
- **Файли моделей**: переконайтеся, що у директорії `ml/model/` створені файли моделей машинного навчання
- **Права доступу**: перевірте, що користувач бази даних має достатні права для створення та зміни таблиць

Логи помилок зберігаються у директорії `logs/` та допомагають діагностувати проблеми з роботою системи.

### Деактивація віртуального середовища

Після завершення роботи з системою деактивуйте віртуальне середовище командою:

```bash
deactivate
```

Тепер система готова до використання та може ефективно відстежувати параметри енергетичного обладнання, виявляти аномалії та автоматично створювати резервні копії критично важливих даних.